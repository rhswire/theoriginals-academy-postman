{
	"info": {
		"_postman_id": "d09ce214-fa68-483c-ab10-21e804d8eae8",
		"name": "05 - Department",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "30861529"
	},
	"item": [
		{
			"name": "Config - Admin",
			"item": [
				{
					"name": "Login - admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"//Como o Token expira a cada 24 horas, fazendo isso ela é gerado automaticamente a cada requisição mesmo após o prazo. \"Token\" é o nome dado a variavel. E depois é onde o valor do token será salvo.\r",
									"pm.globals.set(\"Token\", JSON.parse(responseBody).token);\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{Token}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "query",
									"type": "string"
								},
								{
									"key": "key",
									"value": "token",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"mail\": \"{{MailAdmin}}\",\r\n    \"password\": \"{{PasswordAdmin}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/login/",
							"host": [
								"{{url}}"
							],
							"path": [
								"login",
								""
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Register",
			"item": [
				{
					"name": "Register Department",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Pre-request Script in Postman\r",
									" \r",
									"function generateDepartmentName() {\r",
									"    // Array com nomes representativos de departamentos\r",
									"    var departmentNames = [\r",
									"        \"Desenvolvimento\", \"Marketing\", \"Vendas\", \"Tecnologia\", \"RecursosHumanos\",\r",
									"        \"Financeiro\", \"Compras\", \"Operacional\", \"Logística\", \"AtendimentoCliente\",\r",
									"        \"PesquisaMercado\", \"Design\", \"Qualidade\", \"Estratégia\", \"Jurídico\",\r",
									"        \"Inovação\", \"Sustentabilidade\", \"Comunicação\", \"RelaçõesPúblicas\", \"Segurança\", \"Produção\", \"Engenharia\", \"Contabilidade\", \"AssistênciaTécnica\", \"Treinamento\", \"GestãoDeProjetos\", \"Consultoria\", \"SuporteTécnico\", \"AssuntosRegulatórios\", \"Aquisições\", \"GerenciamentoDeRiscos\", \"Planejamento\", \"Assessoria\", \"Controladoria\", \"MarketingDigital\"\r",
									"    ];\r",
									" \r",
									"    // Seleciona dois departamentos aleatórios do array\r",
									"    var randomDepartment1 = departmentNames[Math.floor(Math.random() * departmentNames.length)];\r",
									"    var randomDepartment2 = departmentNames[Math.floor(Math.random() * departmentNames.length)];\r",
									" \r",
									"    // Combina os nomes dos departamentos com o caractere especial '&', sem espaços\r",
									"    var nameDepartment = randomDepartment1 + \"&\" + randomDepartment2;\r",
									" \r",
									"    // Checa se o tamanho do nome ultrapassa 50 caracteres\r",
									"    if (nameDepartment.length > 50) {\r",
									"        // Se ultrapassar, corta o nome para 50 caracteres\r",
									"        nameDepartment = nameDepartment.substring(0, 50);\r",
									"    }\r",
									" \r",
									"    return nameDepartment;\r",
									"}\r",
									" \r",
									"// Gera um nome para a variável nameDepartment e define como uma variável de ambiente\r",
									"var nameDepartment = generateDepartmentName();\r",
									"pm.environment.set(\"nameDepartment\", nameDepartment); // Define a variável no ambiente"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {\r",
									"    pm.response.to.have.status(201);\r",
									"});\r",
									" \r",
									"// Verifica se a resposta contém a mensagem de sucesso esperada\r",
									"pm.test(\"Verificar mensagem de sucesso\", function () {\r",
									"    var jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.msg).to.eql(\"Cadastro realizado com sucesso.\");\r",
									"});\r",
									" \r",
									"pm.environment.set(\"departmentId\",pm.variables.replaceIn(JSON.parse(responseBody).newDepartment._id));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{Token}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "query",
									"type": "string"
								},
								{
									"key": "key",
									"value": "token",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"departmentName\": \"{{nameDepartment}}\",\r\n  \"costCenterId\": \"{{costCenterId}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/department",
							"host": [
								"{{url}}"
							],
							"path": [
								"department"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Search",
			"item": [
				{
					"name": "Search Department - Success",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{Token}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "query",
									"type": "string"
								},
								{
									"key": "key",
									"value": "token",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/department/{{departmentId}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"department",
								"{{departmentId}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "List",
			"item": [
				{
					"name": "List Department",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{Token}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "query",
									"type": "string"
								},
								{
									"key": "key",
									"value": "token",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/department",
							"host": [
								"{{url}}"
							],
							"path": [
								"department"
							]
						}
					},
					"response": []
				},
				{
					"name": "List Department Count",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "{{Token}}",
									"type": "string"
								},
								{
									"key": "in",
									"value": "query",
									"type": "string"
								},
								{
									"key": "key",
									"value": "token",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/department/count",
							"host": [
								"{{url}}"
							],
							"path": [
								"department",
								"count"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}